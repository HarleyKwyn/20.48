/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: mark@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: david@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

!function(){var t,e,i;!function(n){function s(t,e){return w.call(t,e)}function r(t,e){var i,n,s,r,o,a,u,c,h,l,p,f=e&&e.split("/"),d=g.map,v=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(f=f.slice(0,f.length-1),t=t.split("/"),o=t.length-1,g.nodeIdCompat&&b.test(t[o])&&(t[o]=t[o].replace(b,"")),t=f.concat(t),h=0;h<t.length;h+=1)if(p=t[h],"."===p)t.splice(h,1),h-=1;else if(".."===p){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||v)&&d){for(i=t.split("/"),h=i.length;h>0;h-=1){if(n=i.slice(0,h).join("/"),f)for(l=f.length;l>0;l-=1)if(s=d[f.slice(0,l).join("/")],s&&(s=s[n])){r=s,a=h;break}if(r)break;!u&&v&&v[n]&&(u=v[n],c=h)}!r&&u&&(r=u,a=c),r&&(i.splice(0,a,r),t=i.join("/"))}return t}function o(t,e){return function(){return f.apply(n,T.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return r(e,t)}}function u(t){return function(e){m[t]=e}}function c(t){if(s(y,t)){var e=y[t];delete y[t],_[t]=!0,p.apply(n,e)}if(!s(m,t)&&!s(_,t))throw new Error("No "+t);return m[t]}function h(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return g&&g.config&&g.config[t]||{}}}var p,f,d,v,m={},y={},g={},_={},w=Object.prototype.hasOwnProperty,T=[].slice,b=/\.js$/;d=function(t,e){var i,n=h(t),s=n[0];return t=n[1],s&&(s=r(s,e),i=c(s)),s?t=i&&i.normalize?i.normalize(t,a(e)):r(t,e):(t=r(t,e),n=h(t),s=n[0],t=n[1],s&&(i=c(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},v={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:l(t)}}},p=function(t,e,i,r){var a,h,l,p,f,g,w=[],T=typeof i;if(r=r||t,"undefined"===T||"function"===T){for(e=!e.length&&i.length?["require","exports","module"]:e,f=0;f<e.length;f+=1)if(p=d(e[f],r),h=p.f,"require"===h)w[f]=v.require(t);else if("exports"===h)w[f]=v.exports(t),g=!0;else if("module"===h)a=w[f]=v.module(t);else if(s(m,h)||s(y,h)||s(_,h))w[f]=c(h);else{if(!p.p)throw new Error(t+" missing "+h);p.p.load(p.n,o(r,!0),u(h),{}),w[f]=m[h]}l=i?i.apply(m[t],w):void 0,t&&(a&&a.exports!==n&&a.exports!==m[t]?m[t]=a.exports:l===n&&g||(m[t]=l))}else t&&(m[t]=i)},t=e=f=function(t,e,i,s,r){if("string"==typeof t)return v[t]?v[t](e):c(d(t,e).f);if(!t.splice){if(g=t,g.deps&&f(g.deps,g.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=r),s?p(n,t,e,i):setTimeout(function(){p(n,t,e,i)},4),f},f.config=function(t){return f(t)},t._defined=m,i=function(t,e,i){e.splice||(i=e,e=[]),s(m,t)||s(y,t)||(y[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("famous/core/Entity",["require","exports","module"],function(t,e,i){function n(t){return a[t]}function s(t,e){a[t]=e}function r(t){var e=a.length;return s(e,t),e}function o(t){s(t,null)}var a=[];i.exports={register:r,unregister:o,get:n,set:s}}),i("famous/core/Transform",["require","exports","module"],function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function r(t){return 0>t?-1:1}var o={};o.precision=1e-6,o.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},o.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},o.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},o.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],s=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return o.thenMove(e,[i,n,s])},o.translate=function(t,e,i){return void 0===i&&(i=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,i,1]},o.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},o.scale=function(t,e,i){return void 0===i&&(i=1),[t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1]},o.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},o.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},o.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},o.rotate=function(t,e,i){var n=Math.cos(t),s=Math.sin(t),r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),u=Math.sin(i),c=[r*a,n*u+s*o*a,s*u-n*o*a,0,-r*u,n*a-s*o*u,s*a+n*o*u,0,o,-s*r,n*r,0,0,0,0,1];return c},o.rotateAxis=function(t,e){var i=Math.sin(e),n=Math.cos(e),s=1-n,r=t[0]*t[0]*s,o=t[0]*t[1]*s,a=t[0]*t[2]*s,u=t[1]*t[1]*s,c=t[1]*t[2]*s,h=t[2]*t[2]*s,l=t[0]*i,p=t[1]*i,f=t[2]*i,d=[r+n,o+f,a-p,0,o-f,u+n,c+l,0,a+p,c-l,h+n,0,0,0,0,1];return d},o.aboutOrigin=function(t,e){var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),s=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return o.thenMove(e,[i,n,s])},o.skew=function(t,e,i){return[1,0,0,0,Math.tan(i),1,0,0,Math.tan(e),Math.tan(t),1,0,0,0,0,1]},o.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},o.getTranslate=function(t){return[t[12],t[13],t[14]]},o.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],r=t[0]*t[10]-t[2]*t[8],o=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],h=t[0]*e-t[1]*i+t[2]*n,l=1/h,p=[l*e,-l*s,l*a,0,-l*i,l*r,-l*u,0,l*n,-l*o,l*c,0,0,0,0,1];return p[12]=-t[12]*p[0]-t[13]*p[4]-t[14]*p[8],p[13]=-t[12]*p[1]-t[13]*p[5]-t[14]*p[9],p[14]=-t[12]*p[2]-t[13]*p[6]-t[14]*p[10],p},o.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},o.interpret=function(t){var e=[t[0],t[1],t[2]],i=r(e[0]),a=s(e),u=[e[0]+i*a,e[1],e[2]],c=2/n(u);if(c>=1/0)return{translate:o.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];h[0]=1-c*u[0]*u[0],h[5]=1-c*u[1]*u[1],h[10]=1-c*u[2]*u[2],h[1]=-c*u[0]*u[1],h[2]=-c*u[0]*u[2],h[6]=-c*u[1]*u[2],h[4]=h[1],h[8]=h[2],h[9]=h[6];var l=o.multiply(h,t),p=[l[5],l[6]],f=r(p[0]),d=s(p),v=[p[0]+f*d,p[1]],m=2/n(v),y=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];y[5]=1-m*v[0]*v[0],y[10]=1-m*v[1]*v[1],y[6]=-m*v[0]*v[1],y[9]=y[6];var g=o.multiply(y,h),_=o.multiply(g,t),w=o.scale(_[0]<0?-1:1,_[5]<0?-1:1,_[10]<0?-1:1);_=o.multiply(_,w),g=o.multiply(w,g);var T={};return T.translate=o.getTranslate(t),T.rotate=[Math.atan2(-g[6],g[10]),Math.asin(g[2]),Math.atan2(-g[1],g[0])],T.rotate[0]||(T.rotate[0]=0,T.rotate[2]=Math.atan2(g[4],g[5])),T.scale=[_[0],_[5],_[10]],T.skew=[Math.atan2(_[9],T.scale[2]),Math.atan2(_[8],T.scale[2]),Math.atan2(_[4],T.scale[0])],Math.abs(T.rotate[0])+Math.abs(T.rotate[2])>1.5*Math.PI&&(T.rotate[1]=Math.PI-T.rotate[1],T.rotate[1]>Math.PI&&(T.rotate[1]-=2*Math.PI),T.rotate[1]<-Math.PI&&(T.rotate[1]+=2*Math.PI),T.rotate[0]<0?T.rotate[0]+=Math.PI:T.rotate[0]-=Math.PI,T.rotate[2]<0?T.rotate[2]+=Math.PI:T.rotate[2]-=Math.PI),T},o.average=function(t,e,i){i=void 0===i?.5:i;for(var n=o.interpret(t),s=o.interpret(e),r={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)r.translate[a]=(1-i)*n.translate[a]+i*s.translate[a],r.rotate[a]=(1-i)*n.rotate[a]+i*s.rotate[a],r.scale[a]=(1-i)*n.scale[a]+i*s.scale[a],r.skew[a]=(1-i)*n.skew[a]+i*s.skew[a];return o.build(r)},o.build=function(t){var e=o.scale(t.scale[0],t.scale[1],t.scale[2]),i=o.skew(t.skew[0],t.skew[1],t.skew[2]),n=o.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return o.thenMove(o.multiply(o.multiply(n,i),e),t.translate)},o.equals=function(t,e){return!o.notEquals(t,e)},o.notEquals=function(t,e){return t===e?!1:t&&e?!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]:!0},o.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},o.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],o.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],i.exports=o}),i("famous/core/SpecParser",["require","exports","module","./Transform"],function(t,e,i){function n(){this.result={}}function s(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var r=t("./Transform");n._instance=new n,n.parse=function(t,e){return n._instance.parse(t,e)},n.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,r.identity),this.result},n.prototype.reset=function(){this.result={}};var o=[0,0];n.prototype._parseSpec=function(t,e,i){var n,a,u,c,h,l;if("number"==typeof t){if(n=t,u=e.transform,e.size&&e.origin&&(e.origin[0]||e.origin[1])){var p=[e.origin[0]*e.size[0],e.origin[1]*e.size[1],0];u=r.thenMove(u,s(p,i))}this.result[n]={transform:u,opacity:e.opacity,origin:e.origin||o,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var f=0;f<t.length;f++)this._parseSpec(t[f],e,i);else{a=t.target,u=e.transform,c=e.opacity,h=e.origin,l=e.size;var d=i;if(void 0!==t.opacity&&(c=e.opacity*t.opacity),t.transform&&(u=r.multiply(e.transform,t.transform)),t.origin&&(h=t.origin,d=e.transform),t.size){var v=e.size;l=[t.size[0]||v[0],t.size[1]||v[1]],v&&h&&(h[0]||h[1])&&(u=r.thenMove(u,s([h[0]*v[0],h[1]*v[1],0],i)),u=r.moveThen([-h[0]*l[0],-h[1]*l[1],0],u)),d=e.transform,h=null}this._parseSpec(a,{transform:u,opacity:c,origin:h,size:l},d)}}},i.exports=n}),i("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(t,e,i){function n(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function s(t,e,i){for(var n=o.parse(t,e),a=Object.keys(n),u=0;u<a.length;u++){var c=a[u],h=r.get(c),l=n[c];l.allocator=e.allocator;var p=h.commit(l);p?s(p,e,i):i[c]=l}}var r=t("./Entity"),o=t("./SpecParser");n.prototype.add=function(t){var e=t instanceof n?t:new n(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},n.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},n.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof n?t:this},n.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},n.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),i=0;i<e.length;i++){var n=e[i];if(void 0===this._resultCache[n]){var o=r.get(n);o.cleanup&&o.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},s(this.render(),t,this._resultCache)},n.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,i=0;i<e.length;i++)t[i]=e[i].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},i.exports=n}),i("famous/core/EventEmitter",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var i=this.listeners[t].indexOf(e);return 0>i&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var i=this.listeners[t].indexOf(e);return i>=0&&this.listeners[t].splice(i,1),this},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),i("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,i){function n(){s.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var s=t("./EventEmitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},n.setOutputHandler=function(t,e){e instanceof n&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=e.on,t.removeListener=e.removeListener.bind(e)},n.prototype.emit=function(t,e){s.prototype.emit.apply(this,arguments);var i=0;for(i=0;i<this.downstream.length;i++)this.downstream[i].trigger(t,e);for(i=0;i<this.downstreamFn.length;i++)this.downstreamFn[i](t,e);return this},n.prototype.trigger=n.prototype.emit,n.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return 0>i&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},n.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,i=e.indexOf(t);return i>=0?(e.splice(i,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},n.prototype.on=function(t){if(s.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var i=0;i<this.upstream.length;i++)this.upstream[i].on(t,e)}return this},n.prototype.addListener=n.prototype.on,n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return this},n.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.removeListener(i,this.upstreamListeners[i])}return this},i.exports=n}),i("famous/core/ElementAllocator",["require","exports","module"],function(t,e,i){function n(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.removeChild(e.firstChild));this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return i.length>0?e=i.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t),this.nodeCount--},n.prototype.getNodeCount=function(){return this.nodeCount},i.exports=n}),i("famous/utilities/Utility",["require","exports","module"],function(t,e,i){var n={};n.Direction={X:0,Y:1,Z:2},n.after=function(t,e){var i=t;return function(){i--,0===i&&e.apply(this,arguments)}},n.loadURL=function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},i.open("GET",t),i.send()},n.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var i=document.createDocumentFragment();e.hasChildNodes();)i.appendChild(e.firstChild);return i},i.exports=n}),i("famous/transitions/MultipleTransition",["require","exports","module","famous/utilities/Utility"],function(t,e,i){function n(t){this.method=t,this._instances=[],this.state=[]}var s=t("famous/utilities/Utility");n.SUPPORTS_MULTIPLE=!0,n.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},n.prototype.set=function(t,e,i){for(var n=s.after(t.length,i),r=0;r<t.length;r++)this._instances[r]||(this._instances[r]=new this.method),this._instances[r].set(t[r],e,n)},n.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},i.exports=n}),i("famous/transitions/TweenTransition",["require","exports","module"],function(t,e,i){function n(t){this.options=Object.create(n.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function s(t,e,i){return(1-i)*t+i*e}function r(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function o(t,e){var i={curve:e.curve};return e.duration&&(i.duration=e.duration),e.speed&&(i.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(i.duration=t.duration),t.curve&&(i.curve=t.curve),t.speed&&(i.speed=t.speed)),"string"==typeof i.curve&&(i.curve=n.getCurve(i.curve)),i}function a(t,e,i,n,s){var r,o=1e-7,a=(i(s)-i(s-o))/o;if(t instanceof Array){r=[];for(var u=0;u<t.length;u++)r[u]=a*(t[u]-e[u])/n}else r=a*(t-e)/n;return r}function u(t,e,i){var n;if(t instanceof Array){n=[];for(var r=0;r<t.length;r++)n[r]=s(t[r],e[r],i)}else n=s(t,e,i);return n}n.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},n.SUPPORTS_MULTIPLE=!0,n.DEFAULT_OPTIONS={curve:n.Curves.linear,duration:500,speed:0};var c={};n.registerCurve=function(t,e){return c[t]?!1:(c[t]=e,!0)},n.unregisterCurve=function(t){return c[t]?(delete c[t],!0):!1},n.getCurve=function(t){return c[t]},n.getCurves=function(){return c},n.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),void(i&&i());if(this._startValue=r(this.get()),e=o(e,this.options),e.speed){var n=this._startValue;if(n instanceof Object){var s=0;for(var a in n)s+=(t[a]-n[a])*(t[a]-n[a]);e.duration=Math.sqrt(s)/e.speed}else e.duration=Math.abs(t-n)/e.speed}this._startTime=Date.now(),this._endValue=r(t),this._startVelocity=r(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=i},n.prototype.reset=function(t,e){if(this._callback){var i=this._callback;this._callback=void 0,i()}this.state=r(t),this.velocity=r(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},n.prototype.getVelocity=function(){return this.velocity},n.prototype.get=function(t){return this.update(t),this.state},n.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var i=e/this._duration;this.state=u(this._startValue,this._endValue,this._curve(i)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,i)}}}else if(this._callback){var n=this._callback;this._callback=void 0,n()}},n.prototype.isActive=function(){return this._active},n.prototype.halt=function(){this.reset(this.get())},n.registerCurve("linear",n.Curves.linear),n.registerCurve("easeIn",n.Curves.easeIn),n.registerCurve("easeOut",n.Curves.easeOut),n.registerCurve("easeInOut",n.Curves.easeInOut),n.registerCurve("easeOutBounce",n.Curves.easeOutBounce),n.registerCurve("spring",n.Curves.spring),n.customCurve=function(t,e){return t=t||0,e=e||0,function(i){return t*i+(-2*t-e+3)*i*i+(t+e-2)*i*i*i}},i.exports=n}),i("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(t,e,i){function n(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function s(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,i=this.currentAction[0],n=this.currentAction[1];n instanceof Object&&n.method?(e=n.method,"string"==typeof e&&(e=a[e])):e=o,this._currentMethod!==e&&(this._engineInstance=!(i instanceof Object)||e.SUPPORTS_MULTIPLE===!0||i.length<=e.SUPPORTS_MULTIPLE?new e:new r(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(n.velocity=this.velocity),this._engineInstance.set(i,n,s.bind(this))}var r=t("./MultipleTransition"),o=t("./TweenTransition"),a={};n.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},n.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},n.prototype.set=function(t,e,i){if(!e)return this.reset(t),i&&i(),this;var n=[t,e];return this.actionQueue.push(n),this.callbackQueue.push(i),this.currentAction||s.call(this),this},n.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},n.prototype.delay=function(t,e){this.set(this._engineInstance.get(),{duration:t,curve:function(){return 0}},e)},n.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},n.prototype.isActive=function(){return!!this.currentAction},n.prototype.halt=function(){this.set(this.get())},i.exports=n}),i("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","famous/transitions/Transitionable"],function(t,e,i){function n(t){return[t.clientWidth,t.clientHeight]}function s(t){this.container=t,this._allocator=new a(t),this._node=new r,this._eventOutput=new o,this._size=n(this.container),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:u.identity,opacity:1,origin:h,size:this._size},this._eventOutput.on("resize",function(){this.setSize(n(this.container))}.bind(this))}var r=t("./RenderNode"),o=t("./EventHandler"),a=t("./ElementAllocator"),u=t("./Transform"),c=t("famous/transitions/Transitionable"),h=[0,0];s.prototype.getAllocator=function(){return this._allocator},s.prototype.add=function(t){return this._node.add(t)},s.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},s.prototype.getSize=function(){return this._size},s.prototype.setSize=function(t){t||(t=n(this.container)),this._size[0]=t[0],this._size[1]=t[1]},s.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(this.container.style.perspective=e?e.toFixed()+"px":"",this.container.style.webkitPerspective=e?e.toFixed():"",this._perspective=e),this._node.commit(this._nodeContext)},s.prototype.getPerspective=function(){return this._perspectiveState.get()},s.prototype.setPerspective=function(t,e,i){return this._perspectiveState.set(t,e,i)},s.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},s.prototype.on=function(t,e){return this._eventOutput.on(t,e)},s.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},s.prototype.pipe=function(t){return this._eventOutput.pipe(t)},s.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},i.exports=s}),i("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){this._value=t,this.eventOutput=null}function s(){this.eventOutput=new r,this.eventOutput.bindThis(this),r.setOutputHandler(this,this.eventOutput)}var r=t("./EventHandler");n.patch=function(t){for(var e=new n(t),i=1;i<arguments.length;i++)e.patch(arguments[i]);return t},n.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)n in t&&i[n]&&i[n].constructor===Object&&t[n]&&t[n].constructor===Object?(t.hasOwnProperty(n)||(t[n]=Object.create(t[n])),this.key(n).patch(i[n]),this.eventOutput&&this.eventOutput.emit("change",{id:n,value:this.key(n).value()})):this.set(n,i[n])}return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function(t){var e=new n(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},n.prototype.get=function(t){return this._value[t]},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this.eventOutput&&e!==i&&this.eventOutput.emit("change",{id:t,value:e}),this},n.prototype.value=function(){return this._value},n.prototype.on=function(){return s.call(this),this.on.apply(this,arguments)},n.prototype.removeListener=function(){return s.call(this),this.removeListener.apply(this,arguments)},n.prototype.pipe=function(){return s.call(this),this.pipe.apply(this,arguments)},n.prototype.unpipe=function(){return s.call(this),this.unpipe.apply(this,arguments)},i.exports=n}),i("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(t,e,i){function n(){g.runLoop?(h.step(),requestAnimationFrame(n)):v=!1}function s(t){if(document.activeElement&&"INPUT"===document.activeElement.nodeName)return void document.activeElement.addEventListener("blur",function i(){this.removeEventListener("blur",i),s(t)});window.scrollTo(0,0);for(var e=0;e<l.length;e++)l[e].emit("resize");y.emit("resize")}var r,o,a=t("./Context"),u=t("./EventHandler"),c=t("./OptionsManager"),h={},l=[],p=[],f=[],d=Date.now(),v=!0,m={},y=new u,g={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0},_=new c(g),w=10;h.step=function(){var t=Date.now();if(!(o&&o>t-d)){var e=0;for(r=t-d,d=t,y.emit("prerender"),e=0;e<p.length;e++)p[e].call(this);for(p.splice(0);f.length&&Date.now()-t<w;)f.shift().call(this);for(e=0;e<l.length;e++)l[e].update();y.emit("postrender")}},requestAnimationFrame(n),window.addEventListener("resize",s,!1),s(),window.addEventListener("touchmove",function(t){t.preventDefault()},!0),h.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(h):y.pipe(t)},h.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(h):y.unpipe(t)},h.on=function(t,e){return t in m||(m[t]=y.emit.bind(y,t),document.body.addEventListener(t,m[t])),y.on(t,e)},h.emit=function(t,e){return y.emit(t,e)},h.removeListener=function(t,e){return y.removeListener(t,e)},h.getFPS=function(){return 1e3/r},h.setFPSCap=function(t){o=Math.floor(1e3/t)},h.getOptions=function(){return _.getOptions.apply(_,arguments)},h.setOptions=function(){return _.setOptions.apply(_,arguments)},h.createContext=function(t){if(void 0===t)t=document.createElement(g.containerType),t.classList.add(g.containerClass),document.body.appendChild(t);else if(!(t instanceof Element))throw t=document.createElement(g.containerType),new Error("Tried to create context on non-existent element");var e=new a(t);return h.registerContext(e),e},h.registerContext=function(t){return l.push(t),t},h.nextTick=function(t){p.push(t)},h.defer=function(t){f.push(t)},_.on("change",function(t){"fpsCap"===t.id?h.setFPSCap(t.value):"runLoop"===t.id&&!v&&t.value&&(v=!0,requestAnimationFrame(n))}),i.exports=h}),i("famous/core/Surface",["require","exports","module","./Entity","./EventHandler","./Transform"],function(t,e,i){function n(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new f,this.eventHandler.bindThis(this),this.id=p.register(this),t&&this.setOptions(t),this._currTarget=null}function s(t){for(var e in this.eventHandler.listeners)t.addEventListener(e,this.eventForwarder)}function r(t){for(var e in this.eventHandler.listeners)t.removeEventListener(e,this.eventForwarder)}function o(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function a(t){for(var e in this.properties)t.style[e]=this.properties[e]}function u(t){for(var e in this.properties)t.style[e]=""}function c(t){for(var e="matrix3d(",i=0;15>i;i++)e+=t[i]<1e-6&&t[i]>-1e-6?"0,":t[i]+",";return e+=t[15]+")"}function h(t){return(100*t[0]).toFixed(6)+"% "+(100*t[1]).toFixed(6)+"%"}function l(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var p=t("./Entity"),f=t("./EventHandler"),d=t("./Transform"),v=void 0!==document.body.style.webkitTransform;n.prototype.elementType="div",n.prototype.elementClass="famous-surface",n.prototype.on=function(t,e){this._currTarget&&this._currTarget.addEventListener(t,this.eventForwarder),this.eventHandler.on(t,e)},n.prototype.removeListener=function(t,e){this.eventHandler.removeListener(t,e)},n.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var i=this.eventHandler.emit(t,e);return i&&e.stopPropagation&&e.stopPropagation(),i},n.prototype.pipe=function(t){return this.eventHandler.pipe(t)},n.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},n.prototype.render=function(){return this.id},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];this._stylesDirty=!0},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0)},n.prototype.setClasses=function(t){var e=0,i=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&i.push(this.classList[e]);for(e=0;e<i.length;e++)this.removeClass(i[e]);for(e=0;e<t.length;e++)this.addClass(t[e])},n.prototype.getClassList=function(){return this.classList},n.prototype.setContent=function(t){this.content!==t&&(this.content=t,this._contentDirty=!0)},n.prototype.getContent=function(){return this.content},n.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)
};var m=v?function(t,e){t.style.webkitTransform=c(e)}:function(t,e){t.style.transform=c(e)},y=v?function(t,e){t.style.webkitTransformOrigin=h(e)}:function(t,e){t.style.transformOrigin=h(e)},g=v?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0};n.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)e.classList.add(this.elementClass[i]);else e.classList.add(this.elementClass);e.style.display="",s.call(this,e),y(e,[0,0]),this._currTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=null,this._opacity=void 0,this._origin=null,this._size=null},n.prototype.commit=function(t){this._currTarget||this.setup(t.allocator);var e=this._currTarget,i=t.transform,n=t.opacity,s=t.origin,r=t.size;if(this.size){var u=r;r=[this.size[0],this.size[1]],void 0===r[0]&&u[0]&&(r[0]=u[0]),void 0===r[1]&&u[1]&&(r[1]=u[1])}if(l(this._size,r)&&(this._size=[r[0],r[1]],this._sizeDirty=!0),!i&&this._matrix)return this._matrix=null,this._opacity=0,void g(e);if(this._opacity!==n&&(this._opacity=n,e.style.opacity=n>=1?"0.999999":n),l(this._origin,s)||d.notEquals(this._matrix,i)){i||(i=d.identity),this._matrix=i;var c=i;s&&(this._origin||(this._origin=[0,0]),this._origin[0]=s[0],this._origin[1]=s[1],c=d.moveThen([-this._size[0]*s[0],-this._size[1]*s[1],0],i)),m(e,c)}if(this._classesDirty||this._stylesDirty||this._sizeDirty||this._contentDirty){if(this._classesDirty){o.call(this,e);for(var h=this.getClassList(),p=0;p<h.length;p++)e.classList.add(h[p]);this._classesDirty=!1}this._stylesDirty&&(a.call(this,e),this._stylesDirty=!1),this._sizeDirty&&(this._size&&(e.style.width=this._size[0]!==!0?this._size[0]+"px":"",e.style.height=this._size[1]!==!0?this._size[1]+"px":""),this._sizeDirty=!1),this._contentDirty&&(this.deploy(e),this.eventHandler.emit("deploy"),this._contentDirty=!1)}},n.prototype.cleanup=function(t){var e=0,i=this._currTarget;this.eventHandler.emit("recall"),this.recall(i),i.style.display="none",i.style.width="",i.style.height="",this._size=null,u.call(this,i);var n=this.getClassList();for(o.call(this,i),e=0;e<n.length;e++)i.classList.remove(n[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)i.classList.remove(this.elementClass[e]);else i.classList.remove(this.elementClass);r.call(this,i),this._currTarget=null,t.deallocate(i),g(i)},n.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},n.prototype.getSize=function(t){return t?this._size:this.size||this._size},n.prototype.setSize=function(t){this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0},i.exports=n}),i("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","famous/core/Transform","famous/utilities/Utility"],function(t,e,i){function n(t){this._final=o.identity.slice(),this.translate=new r([0,0,0]),this.rotate=new r([0,0,0]),this.skew=new r([0,0,0]),this.scale=new r([1,1,1]),t&&this.set(t)}function s(){return o.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}var r=t("./Transitionable"),o=t("famous/core/Transform"),a=t("famous/utilities/Utility");n.prototype.setTranslate=function(t,e,i){return this.translate.set(t,e,i),this._final=this._final.slice(),this._final[12]=t[0],this._final[13]=t[1],void 0!==t[2]&&(this._final[14]=t[2]),this},n.prototype.setScale=function(t,e,i){return this.scale.set(t,e,i),this._final=this._final.slice(),this._final[0]=t[0],this._final[5]=t[1],void 0!==t[2]&&(this._final[10]=t[2]),this},n.prototype.setRotate=function(t,e,i){return this.rotate.set(t,e,i),this._final=s.call(this),this._final=o.build({translate:this.translate.get(),rotate:t,scale:this.scale.get(),skew:this.skew.get()}),this},n.prototype.setSkew=function(t,e,i){return this.skew.set(t,e,i),this._final=o.build({translate:this.translate.get(),rotate:this.rotate.get(),scale:this.scale.get(),skew:t}),this},n.prototype.set=function(t,e,i){this._final=t;var n=o.interpret(t),s=i?a.after(4,i):null;return this.translate.set(n.translate,e,s),this.rotate.set(n.rotate,e,s),this.skew.set(n.skew,e,s),this.scale.set(n.scale,e,s),this},n.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},n.prototype.get=function(){return this.isActive()?s.call(this):this._final},n.prototype.getFinal=function(){return this._final},n.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},n.prototype.halt=function(){this._final=this.get(),this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt()},i.exports=n}),i("famous/core/Modifier",["require","exports","module","./Transform","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,i){function n(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._sizeGetter=null,this._legacyStates={},this._output={transform:r.identity,opacity:1,origin:null,size:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.size&&this.sizeFrom(t.size))}function s(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter())}var r=t("./Transform"),o=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");n.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this},n.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},n.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},n.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},n.prototype.setTransform=function(t,e,i){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,i),this):this.transformFrom(t)},n.prototype.setOpacity=function(t,e,i){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new o(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,i)):this.opacityFrom(t)},n.prototype.setOrigin=function(t,e,i){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new o(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,i),this):this.originFrom(t)},n.prototype.setSize=function(t,e,i){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new o(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,i),this):this.sizeFrom(t)},n.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._sizeGetter=null},n.prototype.getTransform=function(){return this._transformGetter()},n.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},n.prototype.getOpacity=function(){return this._opacityGetter()},n.prototype.getOrigin=function(){return this._originGetter()},n.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},n.prototype.modify=function(t){return s.call(this),this._output.target=t,this._output},i.exports=n}),i("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode"],function(t,e,i){function n(t){this._node=new o,this._eventInput=new s,this._eventOutput=new s,s.setInputHandler(this,this._eventInput),s.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new r(this.options),t&&this.setOptions(t)}var s=t("./EventHandler"),r=t("./OptionsManager"),o=t("./RenderNode");n.DEFAULT_OPTIONS={},n.prototype.getOptions=function(){return this._optionsManager.value()},n.prototype.setOptions=function(t){this._optionsManager.patch(t)},n.prototype.add=function(){return this._node.add.apply(this._node,arguments)},n.prototype._add=n.prototype.add,n.prototype.render=function(){return this._node.render()},n.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},i.exports=n}),i("famous/inputs/TouchTracker",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t,e,i,n){var s={};for(var r in t)s[r]=t[r];return{touch:s,origin:e,timestamp:Date.now(),count:n,history:i}}function s(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],s=n(i,t.origin,void 0,t.touches.length);this.eventOutput.emit("trackstart",s),this.selective||this.touchHistory[i.identifier]||this.track(s)}}function r(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],s=this.touchHistory[i.identifier];if(s){var r=n(i,t.origin,s,t.touches.length);this.touchHistory[i.identifier].push(r),this.eventOutput.emit("trackmove",r)}}}function o(t){for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],s=this.touchHistory[i.identifier];if(s){var r=n(i,t.origin,s,t.touches.length);this.eventOutput.emit("trackend",r),delete this.touchHistory[i.identifier]}}}function a(){for(var t in this.touchHistory){var e=this.touchHistory[t];this.eventOutput.emit("trackend",{touch:e[e.length-1].touch,timestamp:Date.now(),count:0,history:e}),delete this.touchHistory[t]}}function u(t){this.selective=t,this.touchHistory={},this.eventInput=new c,this.eventOutput=new c,c.setInputHandler(this,this.eventInput),c.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",s.bind(this)),this.eventInput.on("touchmove",r.bind(this)),this.eventInput.on("touchend",o.bind(this)),this.eventInput.on("touchcancel",o.bind(this)),this.eventInput.on("unpipe",a.bind(this))}var c=t("famous/core/EventHandler");u.prototype.track=function(t){this.touchHistory[t.touch.identifier]=[t]},i.exports=u}),i("famous/inputs/TouchSync",["require","exports","module","./TouchTracker","famous/core/EventHandler"],function(t,e,i){function n(t,e){2===arguments.length?(this._legacyPositionGetter=arguments[0],e=arguments[1]):(this._legacyPositionGetter=null,e=arguments[0]),this.output=new c,this.touchTracker=new u,this.options={direction:void 0,rails:!1,scale:1},this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this.setOptions(e?e:this.options),c.setOutputHandler(this,this.output),c.setInputHandler(this,this.touchTracker),this.touchTracker.on("trackstart",r.bind(this)),this.touchTracker.on("trackmove",o.bind(this)),this.touchTracker.on("trackend",a.bind(this))}function s(){var t=this._payload;t.position=null,t.velocity=null,t.clientX=void 0,t.clientY=void 0,t.count=void 0,t.touch=void 0}function r(t){s.call(this);var e=this._payload;e.count=t.count,e.touch=t.identifier,this.output.emit("start",e)}function o(t){var e=t.history,i=e[e.length-2].timestamp,s=e[e.length-1].timestamp,r=e[e.length-2].touch,o=e[e.length-1].touch,a=o.pageX-r.pageX,u=o.pageY-r.pageY;this.options.rails&&(Math.abs(a)>Math.abs(u)?u=0:a=0);var c,h,l,p,f=Math.max(s-i,8),d=a/f,v=u/f,m=this.options.scale;this.options.direction===n.DIRECTION_X?(c=this._legacyPositionGetter?this._legacyPositionGetter():0,p=m*a,h=c+p,l=m*d):this.options.direction===n.DIRECTION_Y?(c=this._legacyPositionGetter?this._legacyPositionGetter():0,p=m*u,h=c+p,l=m*v):(c=this._legacyPositionGetter?this._legacyPositionGetter():[0,0],p=[m*a,m*u],h=[c[0]+p[0],c[1]+p[1]],l=[m*d,m*v]);var y=this._payload;y.delta=p,y.position=h,y.velocity=l,y.clientX=t.touch.clientX,y.clientY=t.touch.clientY,y.count=t.count,y.touch=t.touch.identifier,this.output.emit("update",y)}function a(t){var e=void 0!==this.options.direction?0:[0,0],i=t.history,s=t.count;if(i.length>1){var r=i[i.length-2].timestamp,o=i[i.length-1].timestamp,a=i[i.length-2].touch,u=i[i.length-1].touch,c=u.pageX-a.pageX,h=u.pageY-a.pageY;this.options.rails&&(Math.abs(c)>Math.abs(h)?h=0:c=0);var l=Math.max(o-r,1),p=c/l,f=h/l,d=this.options.scale;e=this.options.direction===n.DIRECTION_X?d*p:this.options.direction===n.DIRECTION_Y?d*f:[d*p,d*f]}var v=this._payload;v.velocity=e,v.clientX=t.clientX,v.clientY=t.clientY,v.count=s,v.touch=t.touch.identifier,this.output.emit("end",v)}var u=t("./TouchTracker"),c=t("famous/core/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale)},n.prototype.getOptions=function(){return this.options},i.exports=n}),i("famous/inputs/ScrollSync",["require","exports","module","famous/core/EventHandler","famous/core/Engine"],function(t,e,i){function n(t,e){2===arguments.length?(this._legacyPositionGetter=arguments[0],e=arguments[1]):(this._legacyPositionGetter=null,e=arguments[0]),this.options={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40},this.setOptions(e?e:this.options),this._payload={delta:null,position:null,velocity:null,slip:!0},this.input=new o,this.output=new o,o.setInputHandler(this,this.input),o.setOutputHandler(this,this.output),this._prevTime=void 0,this._prevVel=void 0,this.input.on("mousewheel",r.bind(this)),this.input.on("wheel",r.bind(this)),this.inProgress=!1,this._loopBound=!1}function s(){var t=Date.now();if(this.inProgress&&t-this._prevTime>this.options.stallTime){var e=void 0===this.options.direction?this._legacyPositionGetter?this._legacyPositionGetter:[0,0]:this._legacyPositionGetter?this._legacyPositionGetter:0;this.inProgress=!1;var i=0;Math.abs(this._prevVel)>=this.options.minimumEndSpeed&&(i=this._prevVel);var n=this._payload;n.position=e,n.velocity=i,n.slip=!0,this.output.emit("end",n)}}function r(t){t.preventDefault(),this.inProgress||(this.inProgress=!0,this.output.emit("start",{slip:!0}),this._loopBound||(a.on("prerender",s.bind(this)),this._loopBound=!0));var e=this._prevTime||Date.now(),i=void 0!==t.wheelDeltaX?t.wheelDeltaX:-t.deltaX,r=void 0!==t.wheelDeltaY?t.wheelDeltaY:-t.deltaY;1===t.deltaMode&&(i*=this.options.lineHeight,r*=this.options.lineHeight);var o=Date.now();this.options.rails&&(Math.abs(i)>Math.abs(r)?r=0:i=0);var u,c,h,l,p=Math.max(o-e,8),f=i/p,d=r/p,v=this.options.scale;this.options.direction===n.DIRECTION_X?(u=this._legacyPositionGetter?this._legacyPositionGetter():0,l=v*i,c=u+l,h=v*f):this.options.direction===n.DIRECTION_Y?(u=this._legacyPositionGetter?this._legacyPositionGetter():0,l=v*r,c=u+l,h=v*d):(u=this._legacyPositionGetter?this._legacyPositionGetter():[0,0],l=[v*i,v*r],c=[u[0]+l[0],u[1]+l[1]],h=[v*f,v*d]);var m=this._payload;m.delta=l,m.position=c,m.velocity=h,m.slip=!0,this.output.emit("update",m),this._prevTime=o,this._prevVel=h}var o=t("famous/core/EventHandler"),a=t("famous/core/Engine");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.minimumEndSpeed&&(this.options.minimumEndSpeed=t.minimumEndSpeed),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime)},i.exports=n}),i("famous/inputs/GenericSync",["require","exports","module","famous/core/EventHandler","./TouchSync","./ScrollSync"],function(t,e,i){function n(t,e){2===arguments.length?this._legacyPositionGetter=t:(this._legacyPositionGetter=null,e=t),this.eventInput=new r,this.eventOutput=new r,r.setInputHandler(this,this.eventInput),r.setOutputHandler(this,this.eventOutput),this._handlers=void 0,e?(this.options=e,e.syncClasses||(this.options.syncClasses=u),this.setOptions(e)):this.options={syncClasses:u},this._handlers&&s.call(this)}function s(){var t=null,e=0;if(this._handlers)for(e=0;e<this._handlers.length;e++)this.eventInput.unpipe(this._handlers[e]),this._handlers[e].unpipe(this.eventOutput);for(this._handlers=[],e=0;e<this.options.syncClasses.length;e++)t=this.options.syncClasses[e],this._handlers[e]=new t(this._legacyPositionGetter,this._handlerOptions),this.eventInput.pipe(this._handlers[e]),this._handlers[e].pipe(this.eventOutput)}var r=t("famous/core/EventHandler"),o=t("./TouchSync"),a=t("./ScrollSync"),u=[o,a];n.register=function(t){u.indexOf(t)<0&&u.push(t)},n.DIRECTION_X=0,n.DIRECTION_Y=1,n.DIRECTION_Z=2,n.prototype.setOptions=function(t){if(this._handlerOptions=t,t.syncClasses&&(this.options.syncClasses=t.syncClasses,s.call(this)),this._handlers)for(var e=0;e<this._handlers.length;e++)this._handlers[e].setOptions(this._handlerOptions)},i.exports=n}),i("src/controller",["require","exports","module","famous/core/EventHandler"],function(t,e,i){var n=t("famous/core/EventHandler"),s=new n;i.exports=s}),i("src/ScoreView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","src/controller"],function(t,e,i){function n(){c.apply(this,arguments),s.call(this),r.call(this)}function s(){var t=new o({size:[p,l],properties:{border:"1px solid grey",borderRadius:"5px"}});this.scoreTitleSurface=new o({size:[p,l/2],content:this.options.scoreTitle,properties:{color:"white",fontSize:"20px",textAlign:"center"}}),this.scoreTitleModifier=new a,this.scoreValueSurface=new o({size:[p,l/2],content:this.options.scoreValue,properties:{color:"white",fontSize:" 20px",textAlign:"center"}}),this.scoreValueModifier=new a({transform:u.translate(0,23,0)}),this._add(t),this._add(this.scoreTitleSurface),this._add(this.scoreValueModifier).add(this.scoreValueSurface)}function r(){h.on("scoreUpdate",function(t){this.options.scoreTitle===t.title&&this.scoreValueSurface.setContent(t.value)}.bind(this))}var o=t("famous/core/Surface"),a=t("famous/core/Modifier"),u=t("famous/core/Transform"),c=t("famous/core/View"),h=t("src/controller"),l=50,p=100;n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={scoreValue:"0",scoreTitle:"Score"},i.exports=n}),i("src/local_storage_manager",["require","exports","module"],function(t,e){function i(){this.bestScoreKey="bestScore",this.gameStateKey="gameState";var t=this.localStorageSupported();this.storage=t?window.localStorage:window.fakeStorage}window.fakeStorage={_data:{},setItem:function(t,e){return this._data[t]=String(e)},getItem:function(t){return this._data.hasOwnProperty(t)?this._data[t]:void 0},removeItem:function(t){return delete this._data[t]},clear:function(){return this._data={}}},i.prototype.localStorageSupported=function(){var t="test",e=window.localStorage;try{return e.setItem(t,"1"),e.removeItem(t),!0}catch(i){return!1}},i.prototype.getBestScore=function(){return this.storage.getItem(this.bestScoreKey)||0},i.prototype.setBestScore=function(t){this.storage.setItem(this.bestScoreKey,t)},i.prototype.getGameState=function(){var t=this.storage.getItem(this.gameStateKey);return t?JSON.parse(t):null},i.prototype.setGameState=function(t){this.storage.setItem(this.gameStateKey,JSON.stringify(t))},i.prototype.clearGameState=function(){this.storage.removeItem(this.gameStateKey)},e.exports=i}),i("src/HeaderView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","src/ScoreView","src/controller","src/local_storage_manager"],function(t,e,i){function n(){u.apply(this,arguments),s.call(this)}function s(){var t=new r({size:[f,d],properties:{color:"white",backgroundColor:"black"}});this.newGameButton=new r({size:[100,50],content:"New Game",properties:{color:"white",border:"1px solid grey",borderRadius:"5px",textAlign:"center"}}),this.newGameButton.on("click",function(){h.emit("restart")}.bind(this)),this.newGameMod=new o({transform:a.translate(150,150,0)}),this.titleSurface=new r({size:[f/2,d],content:"20.48",properties:{color:"white",fontSize:"50px",textAlign:"center"}});var e=new c({scoreTitle:"Best",scoreValue:""+p.getBestScore()}),i=new c({scoreTitle:"Score",scoreValue:"0"});this.bestScoreModifier=new o({transform:a.translate(150,25,0)}),this.scoreModifier=new o({origin:[.5,0],transform:a.translate(150,85,0)}),this.backgrounModifier=new o,this.titleModifier=new o({origin:[.5,0],transform:a.translate(-100,25,0)}),this._add(t),this._add(this.titleModifier).add(this.titleSurface),this._add(this.bestScoreModifier).add(e),this._add(this.scoreModifier).add(i),this._add(this.newGameMod).add(this.newGameButton)}var r=t("famous/core/Surface"),o=t("famous/core/Modifier"),a=t("famous/core/Transform"),u=t("famous/core/View"),c=t("src/ScoreView"),h=t("src/controller"),l=t("src/local_storage_manager"),p=new l.exports,f=500,d=250;n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("src/TileView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View"],function(t,e,i){function n(){a.apply(this,arguments),s.call(this)}function s(){this.tileSurface=new r({size:this.options.size,content:this.options.value,properties:{backgroundColor:"grey",borderRadius:"3px"}}),this.tileMod=new o({opacity:.5}),this._add(this.tileMod).add(this.tileSurface)}var r=t("famous/core/Surface"),o=t("famous/core/Modifier"),a=(t("famous/core/Transform"),t("famous/core/View"));n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={size:[100,100],value:"ha"},i.exports=n}),i("famous/transitions/Easing",["require","exports","module"],function(t,e,i){var n={inQuad:function(t){return t*t},outQuad:function(t){return-(t-=1)*t+1},inOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},inQuart:function(t){return t*t*t*t},outQuart:function(t){return-(--t*t*t*t-1)},inOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return--t*t*t*t*t+1},inOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},inSine:function(t){return-1*Math.cos(t*(Math.PI/2))+1},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},inExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},outExpo:function(t){return 1===t?1:-Math.pow(2,-10*t)+1},inOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},inCirc:function(t){return-(Math.sqrt(1-t*t)-1)},outCirc:function(t){return Math.sqrt(1- --t*t)},inOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},inElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)))},outElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1===t?1:(i||(i=.3),e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/i)+1)},inOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2===(t/=.5)?1:(i||(i=.3*1.5),e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/i)*.5+1)},inBack:function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)},outBack:function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1},inOutBack:function(t,e){return void 0===e&&(e=1.70158),(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},inBounce:function(t){return 1-n.outBounce(1-t)},outBounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},inOutBounce:function(t){return.5>t?.5*n.inBounce(2*t):.5*n.outBounce(2*t-1)+.5}};i.exports=n}),i("famous/utilities/Timer",["require","exports","module","famous/core/Engine"],function(t,e,i){function n(t){return h.on(l,t),t}function s(t,e){var i=p(),s=function(){var n=p();n-i>=e&&(t.apply(this,arguments),h.removeListener(l,s))};return n(s)}function r(t,e){var i=p(),s=function(){var n=p();n-i>=e&&(t.apply(this,arguments),i=p())};return n(s)}function o(t,e){if(void 0===e)return void 0;var i=function(){e--,0>=e&&(t.apply(this,arguments),u(i))};return n(i)}function a(t,e){e=e||1;var i=e,s=function(){e--,0>=e&&(t.apply(this,arguments),e=i)};return n(s)}function u(t){h.removeListener(l,t)}function c(t,e){var i,n,r,o,a;return function(){n=this,a=arguments,r=p();var u=function(){var c=p-r;e>c?i=s(u,e-c):(i=null,o=t.apply(n,a))};return i||(i=s(u,e)),o}}var h=t("famous/core/Engine"),l="prerender",p=window.performance?function(){return window.performance.now()}:function(){return Date.now()};i.exports={setTimeout:s,setInterval:r,debounce:c,after:o,every:a,clear:u}}),i("src/tile",["require","exports","module"],function(t,e){function i(t,e){this.x=t.x,this.y=t.y,this.value=e||2,this.previousPosition=null,this.mergedFrom=null}i.prototype.savePosition=function(){this.previousPosition={x:this.x,y:this.y}},i.prototype.updatePosition=function(t){this.x=t.x,this.y=t.y},i.prototype.serialize=function(){return{position:{x:this.x,y:this.y},value:this.value}},e.exports=i}),i("src/grid",["require","exports","module","src/tile","src/controller"],function(t,e){function i(t,e){this.size=t,this.cells=e?this.fromState(e):this.empty()}{var n=t("src/tile");t("src/controller")}i.prototype.empty=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],n=0;n<this.size;n++)i.push(null);return t},i.prototype.fromState=function(t){for(var e=[],i=0;i<this.size;i++)for(var s=e[i]=[],r=0;r<this.size;r++){var o=t[i][r];s.push(o?new n.exports(o.position,o.value):null)}return e},i.prototype.randomAvailableCell=function(){var t=this.availableCells();return t.length?t[Math.floor(Math.random()*t.length)]:void 0},i.prototype.availableCells=function(){var t=[];return this.eachCell(function(e,i,n){n||t.push({x:e,y:i})}),t},i.prototype.eachCell=function(t){for(var e=0;e<this.size;e++)for(var i=0;i<this.size;i++)t(e,i,this.cells[e][i])},i.prototype.cellsAvailable=function(){return!!this.availableCells().length},i.prototype.cellAvailable=function(t){return!this.cellOccupied(t)},i.prototype.cellOccupied=function(t){return!!this.cellContent(t)},i.prototype.cellContent=function(t){return this.withinBounds(t)?this.cells[t.x][t.y]:null},i.prototype.insertTile=function(t){this.cells[t.x][t.y]=t},i.prototype.removeTile=function(t){this.cells[t.x][t.y]=null},i.prototype.withinBounds=function(t){return t.x>=0&&t.x<this.size&&t.y>=0&&t.y<this.size},i.prototype.serialize=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],n=0;n<this.size;n++)i.push(this.cells[e][n]?this.cells[e][n].serialize():null);return{size:this.size,cells:t}},e.exports=i}),i("src/keyboard_input_manager",["require","exports","module","src/controller"],function(t,e){function i(){this.events={},this.listen()}var n=t("src/controller");i.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},i.prototype.emit=function(t,e){var i=this.events[t];i&&i.forEach(function(t){t(e)})},i.prototype.listen=function(){var t=this,e={38:0,39:1,40:2,37:3,75:0,76:1,74:2,72:3,87:0,68:1,83:2,65:3};document.addEventListener("keydown",function(i){var s=i.altKey||i.ctrlKey||i.metaKey||i.shiftKey,r=e[i.which];s||void 0!==r&&(i.preventDefault(),n.emit("move",r)),s||82!==i.which||t.restart.call(t,i)})},i.prototype.restart=function(t){t.preventDefault(),n.emit("restart")},i.prototype.keepPlaying=function(t){t.preventDefault(),n.emit("keepPlaying")},e.exports=i}),i("src/html_actuator",["require","exports","module","src/controller"],function(t,e,i){function n(){this.score=0}var s=t("src/controller");n.prototype.actuate=function(t,e){var i=this;window.requestAnimationFrame(function(){s.emit("clear"),t.cells.forEach(function(t){t.forEach(function(t){t&&i.addTile(t)})}),i.updateScore(e.score),i.updateBestScore(e.bestScore),e.terminated&&(e.over?i.message(!1):e.won&&i.message(!0))})},n.prototype.continueGame=function(){this.clearMessage()},n.prototype.clearContainer=function(){},n.prototype.addTile=function(t){var e=this;t.mergedFrom&&t.mergedFrom.forEach(function(t){e.addTile(t)}),s.emit("addTile",{tile:t})},n.prototype.normalizePosition=function(t){return{x:t.x+1,y:t.y+1}},n.prototype.updateScore=function(t){s.emit("scoreUpdate",{title:"Score",value:t}),this.score+=t-this.score},n.prototype.updateBestScore=function(t){s.emit("scoreUpdate",{title:"Best",value:t})},n.prototype.message=function(t){var e=t?"game-won":"game-over";s.emit(e)},n.prototype.clearMessage=function(){},i.exports=n}),i("src/game_manager",["require","exports","module","src/grid","src/tile","src/controller"],function(t,e){function i(t,e,i,n){this.size=t,this.inputManager=new e,this.storageManager=new n,this.actuator=new i,this.startTiles=2,this.inputManager.on("move",this.move.bind(this)),this.inputManager.on("restart",this.restart.bind(this)),r.on("move",this.move.bind(this)),r.on("restart",this.restart.bind(this)),r.on("keepPlaying",this.keepPlaying.bind(this)),this.setup()}var n=t("src/grid"),s=t("src/tile"),r=t("src/controller");i.prototype.restart=function(){this.storageManager.clearGameState(),this.actuator.continueGame(),this.setup()},i.prototype.keepPlaying=function(){this.keepPlaying=!0,this.actuator.continueGame()},i.prototype.isGameTerminated=function(){return this.over||this.won&&!this.keepPlaying},i.prototype.setup=function(){var t=this.storageManager.getGameState();t?(this.grid=new n.exports(t.grid.size,t.grid.cells),this.score=t.score,this.over=t.over,this.won=t.won,this.keepPlaying=t.keepPlaying):(this.grid=new n.exports(this.size),this.score=0,this.over=!1,this.won=!1,this.keepPlaying=!1,this.addStartTiles()),this.actuate(),r.emit("begin")},i.prototype.addStartTiles=function(){for(var t=0;t<this.startTiles;t++)this.addRandomTile()},i.prototype.addRandomTile=function(){if(this.grid.cellsAvailable()){var t=Math.random()<.9?2:4,e=new s.exports(this.grid.randomAvailableCell(),t);r.emit("addTile",{tile:e}),this.grid.insertTile(e)}},i.prototype.actuate=function(){this.storageManager.getBestScore()<this.score&&this.storageManager.setBestScore(this.score),this.over?this.storageManager.clearGameState():this.storageManager.setGameState(this.serialize()),this.actuator.actuate(this.grid,{score:this.score,over:this.over,won:this.won,bestScore:this.storageManager.getBestScore(),terminated:this.isGameTerminated()})
},i.prototype.serialize=function(){return{grid:this.grid.serialize(),score:this.score,over:this.over,won:this.won,keepPlaying:this.keepPlaying}},i.prototype.prepareTiles=function(){this.grid.eachCell(function(t,e,i){i&&(i.mergedFrom=null,i.savePosition())})},i.prototype.moveTile=function(t,e){this.grid.cells[t.x][t.y]=null,this.grid.cells[e.x][e.y]=t,t.updatePosition(e)},i.prototype.move=function(t){var e=this;if(!this.isGameTerminated()){var i,n,r=this.getVector(t),o=this.buildTraversals(r),a=!1;this.prepareTiles(),o.x.forEach(function(t){o.y.forEach(function(o){if(i={x:t,y:o},n=e.grid.cellContent(i)){var u=e.findFarthestPosition(i,r),c=e.grid.cellContent(u.next);if(c&&c.value===n.value&&!c.mergedFrom){var h=new s.exports(u.next,2*n.value);h.mergedFrom=[n,c],e.grid.insertTile(h),e.grid.removeTile(n),n.updatePosition(u.next),e.score+=h.value,2048===h.value&&(e.won=!0)}else e.moveTile(n,u.farthest);e.positionsEqual(i,n)||(a=!0)}})}),a&&(this.addRandomTile(),this.movesAvailable()||(this.over=!0),this.actuate())}},i.prototype.getVector=function(t){var e={0:{x:0,y:-1},1:{x:1,y:0},2:{x:0,y:1},3:{x:-1,y:0}};return e[t]},i.prototype.buildTraversals=function(t){for(var e={x:[],y:[]},i=0;i<this.size;i++)e.x.push(i),e.y.push(i);return 1===t.x&&(e.x=e.x.reverse()),1===t.y&&(e.y=e.y.reverse()),e},i.prototype.findFarthestPosition=function(t,e){var i;do i=t,t={x:i.x+e.x,y:i.y+e.y};while(this.grid.withinBounds(t)&&this.grid.cellAvailable(t));return{farthest:i,next:t}},i.prototype.movesAvailable=function(){return this.grid.cellsAvailable()||this.tileMatchesAvailable()},i.prototype.tileMatchesAvailable=function(){for(var t,e=this,i=0;i<this.size;i++)for(var n=0;n<this.size;n++)if(t=this.grid.cellContent({x:i,y:n}))for(var s=0;4>s;s++){var r=e.getVector(s),o={x:i+r.x,y:n+r.y},a=e.grid.cellContent(o);if(a&&a.value===t.value)return!0}return!1},i.prototype.positionsEqual=function(t,e){return t.x===e.x&&t.y===e.y},e.exports=i}),i("src/application",["require","exports","module","src/keyboard_input_manager","src/html_actuator","src/local_storage_manager","src/game_manager"],function(t,e){var i=t("src/keyboard_input_manager"),n=t("src/html_actuator"),s=t("src/local_storage_manager"),r=t("src/game_manager");e.exports=new r.exports(4,i.exports,n,s.exports)}),i("famous/math/Random",["require","exports","module"],function(t,e,i){function n(t,e){return t+r()*(e-t)}function s(t,e){return t+r()*(e-t+1)>>0}var r=Math.random,o={};o.integer=function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var n=[],r=0;i>r;r++)n.push(s(t,e));return n}return s(t,e)},o.range=function(t,e,i){if(t=void 0!==t?t:0,e=void 0!==e?e:1,void 0!==i){for(var s=[],r=0;i>r;r++)s.push(n(t,e));return s}return n(t,e)},o.sign=function(t){return t=void 0!==t?t:.5,r()<t?1:-1},o.bool=function(t){return t=void 0!==t?t:.5,r()<t},i.exports=o}),i("src/GameView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","src/TileView","famous/transitions/Easing","famous/utilities/Timer","famous/core/EventHandler","src/grid","src/application","src/controller","famous/math/Random"],function(t,e,i){function n(){p.apply(this,arguments),s.call(this),r.call(this),u.call(this),o.call(this)}function s(){this.backgroundSurface=new c({size:[_,g],properties:{border:"1px solid grey"}}),this.backgroundSurface.pipe(this._eventOutput),this._add(this.backgroundSurface)}function r(){this.tileModifiers=[],this.tileRModifiers=[],this.tiles=[];for(var t=0;4>t;t++){this.tiles.push([]),this.tileModifiers.push([]),this.tileRModifiers.push([]);for(var e=0;4>e;e++){var i=new c({size:[100,100],content:"",properties:{backgroundColor:"grey",borderRadius:"3px",color:"black"}}),n=new h({origin:[.5,0],opacity:.5,transform:l.translate(-1e3,-1e3,100)});this.tiles[t].push(i),this.tileModifiers[t].push(n);var s=new h({transform:l.rotateZ(0)});this.tileRModifiers[t].push(s),this._add(n).add(s).add(i)}}}function o(){this.positions=[];for(var t=0;4>t;t++){this.positions.push([]);for(var e=0;4>e;e++)this.positions[t].push([125*t,125*e])}}function a(){for(var t=0;t<this.tileModifiers.length;t++)for(var e=0;e<this.tileModifiers[t].length;e++)d.setTimeout(function(t,e){this.tileModifiers[t][e].setTransform(l.translate(this.positions[t][e][0]-186.5,this.positions[t][e][1]+13.5),{duration:1e3,curve:f.outQuint})}.bind(this,t,e),100*t)}function u(){this.eventHandler=new v,this.eventHandler.subscribe(y),this.eventHandler.on("clear",function(){this.tiles.forEach(function(t){t.forEach(function(t){t.setContent("")})})}.bind(this)),this.eventHandler.on("game-over",function(){for(var t=0;4>t;t++)for(var e=0;4>e;e++)d.setTimeout(function(t,e){this.tileRModifiers[t][e].setTransform(l.rotateZ(t),{duration:1e3}),this.tileModifiers[t][e].setOpacity(.5),this.tileModifiers[t][e].setTransform(l.translate(this.positions[t][e][0]-186.5,500),{duration:1e3,curve:f.outQuint})}.bind(this,t,e),100*t)}.bind(this)),this.eventHandler.on("restart",function(){for(var t=0;4>t;t++)for(var e=0;4>e;e++)this.tileModifiers[t][e].setOpacity(1),this.tileRModifiers[t][e].setTransform(l.rotateZ(0)),this.tileModifiers[t][e].setTransform(l.translate(-1e3,-1e3,100)),d.setTimeout(function(t,e){this.tileModifiers[t][e].setOpacity(.5),this.tileModifiers[t][e].setTransform(l.translate(this.positions[t][e][0]-186.5,this.positions[t][e][1]+13.5),{duration:1e3,curve:f.outQuint})}.bind(this,t,e),100*t)}.bind(this)),this.eventHandler.on("addTile",function(t){var e=t.tile.x,i=t.tile.y;if(t.tile.previousPosition){var n=t.tile.previousPosition.x,s=t.tile.previousPosition.y;if(n!==e||s!==i){var r=this.tileModifiers[n][s];r.setTransform(l.translate(125*n-186.5,125*s+13.5,100),{duration:50,curve:f.outQuint}),r.setTransform(l.translate(125*e-186.5,125*i+13.5),{duration:100,curve:f.outQuint}),r.setTransform(l.translate(125*e-186.5,125*i+13.5,0),{duration:50,curve:f.outQuint}),r.setOpacity(1),r.setTransform(l.translate(125*n-186.5,125*s+13.5),{duration:0}),r.setOpacity(.5)}}this.tiles[t.tile.x][t.tile.y].setContent(t.tile.value)}.bind(this)),m.exports.setup(),a.call(this)}var c=t("famous/core/Surface"),h=t("famous/core/Modifier"),l=t("famous/core/Transform"),p=t("famous/core/View"),f=(t("src/TileView"),t("famous/transitions/Easing")),d=t("famous/utilities/Timer"),v=t("famous/core/EventHandler"),m=(t("src/grid"),t("src/application")),y=t("src/controller"),g=(t("famous/math/Random"),500),_=500;n.prototype=Object.create(p.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("src/PageView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","src/HeaderView","src/GameView"],function(t,e,i){function n(){h.apply(this,arguments),s.call(this),o.call(this),r.call(this)}function s(){this.backgroundSurface=new a({size:[void 0,void 0],properties:{backgroundColor:"black"}}),this._add(this.backgroundSurface)}function r(){this.gameView=new p({size:[500,500]}),this.gameViewMod=new u({origin:[.5,0],transform:c.translate(0,250,0)}),this.gameView.pipe(this._eventOutput),this._add(this.gameViewMod).add(this.gameView)}function o(){this.headerView=new l,this._add(this.headerView)}var a=t("famous/core/Surface"),u=t("famous/core/Modifier"),c=t("famous/core/Transform"),h=t("famous/core/View"),l=t("src/HeaderView"),p=t("src/GameView");n.prototype=Object.create(h.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("src/AppView",["require","exports","module","famous/core/Engine","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","famous/inputs/GenericSync","famous/inputs/TouchSync","src/controller","./PageView"],function(t,e,i){function n(){a.apply(this,arguments),s.call(this),r.call(this)}function s(){this.pageView=new h({size:[500,1e3]}),this.pageMod=new o({origin:[.5,0]}),this._add(this.pageMod).add(this.pageView)}function r(){this.latteralSync=new u(function(){return this.pageViewX}.bind(this),{direction:u.DIRECTION_X}),this.verticalSync=new u(function(){return this.pageViewY}.bind(this),{direction:u.DIRECTION_Y}),this.pageView.pipe(this.latteralSync),this.pageView.pipe(this.verticalSync),this.latteralSync.on("update",function(t){Math.abs(t.delta)>10&&console.log("x = "+t.position)}.bind(this)),this.verticalSync.on("update",function(t){Math.abs(t.delta)>10&&(console.log(this),console.log("y = "+t.position))}.bind(this))}var o=(t("famous/core/Engine"),t("famous/core/Surface"),t("famous/core/Modifier")),a=(t("famous/core/Transform"),t("famous/core/View")),u=t("famous/inputs/GenericSync"),c=t("famous/inputs/TouchSync"),h=(t("src/controller"),t("./PageView"));u.register(c),n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={},i.exports=n}),i("famous/inputs/MouseSync",["require","exports","module","famous/core/EventHandler"],function(t,e,i){function n(t,e){2===arguments.length?(this._legacyPositionGetter=arguments[0],e=arguments[1]):(this._legacyPositionGetter=null,e=arguments[0]),this.options={direction:void 0,rails:!1,scale:1,stallTime:50,propogate:!0},this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,offsetX:void 0,offsetY:void 0},this.setOptions(e?e:this.options),this.input=new c,this.output=new c,c.setInputHandler(this,this.input),c.setOutputHandler(this,this.output),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0,this.input.on("mousedown",r.bind(this)),this.input.on("mousemove",o.bind(this)),this.input.on("mouseup",a.bind(this)),this.options.propogate?this.input.on("mouseleave",u.bind(this)):this.input.on("mouseleave",a.bind(this))}function s(){var t=this._payload;t.delta=null,t.position=null,t.velocity=null,t.clientX=void 0,t.clientY=void 0,t.offsetX=void 0,t.offsetY=void 0}function r(t){t.preventDefault(),s.call(this);var e=t.clientX,i=t.clientY;this._prevCoord=[e,i],this._prevTime=Date.now(),this._prevVel=void 0!==this.options.direction?0:[0,0];var n=this._payload;n.clientX=e,n.clientY=i,n.offsetX=t.offsetX,n.offsetY=t.offsetY,this.output.emit("start",n)}function o(t){if(this._prevCoord){var e=this._prevCoord,i=this._prevTime,s=t.clientX,r=t.clientY,o=[s,r],a=Date.now(),u=o[0]-e[0],c=o[1]-e[1];this.options.rails&&(Math.abs(u)>Math.abs(c)?c=0:u=0);var h,l,p,f,d=Math.max(a-i,8),v=u/d,m=c/d,y=this.options.scale;this.options.direction===n.DIRECTION_X?(h=this._legacyPositionGetter?this._legacyPositionGetter():0,f=y*u,l=h+f,p=y*v):this.options.direction===n.DIRECTION_Y?(h=this._legacyPositionGetter?this._legacyPositionGetter():0,f=y*c,l=h+f,p=y*m):(h=this._legacyPositionGetter?this._legacyPositionGetter():[0,0],f=[y*u,y*c],l=[h[0]+f[0],h[1]+f[1]],p=[y*v,y*m]);var g=this._payload;g.delta=f,g.position=l,g.velocity=p,g.clientX=s,g.clientY=r,g.offsetX=t.offsetX,g.offsetY=t.offsetY,this.output.emit("update",g),this._prevCoord=o,this._prevTime=a,this._prevVel=p}}function a(t){if(this._prevCoord){var e=this._prevTime,i=Date.now();i-e>this.options.stallTime&&(this._prevVel=void 0===this.options.direction?[0,0]:0);var n=this._payload;n.velocity=this._prevVel,n.clientX=t.clientX,n.clientY=t.clientY,n.offsetX=t.offsetX,n.offsetY=t.offsetY,this.output.emit("end",n),this._prevCoord=void 0,this._prevTime=void 0,this._prevVel=void 0}}function u(){if(this._prevCoord){var t=o.bind(this),e=function(i){a.call(this,i),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",e)}.bind(this);document.addEventListener("mousemove",t),document.addEventListener("mouseup",e)}}var c=t("famous/core/EventHandler");n.DIRECTION_X=0,n.DIRECTION_Y=1,n.prototype.getOptions=function(){return this.options},n.prototype.setOptions=function(t){void 0!==t.direction&&(this.options.direction=t.direction),void 0!==t.rails&&(this.options.rails=t.rails),void 0!==t.scale&&(this.options.scale=t.scale),void 0!==t.stallTime&&(this.options.stallTime=t.stallTime),void 0!==t.propogate&&(this.options.propogate=t.propogate)},i.exports=n}),i("famous/inputs/FastClick",["require","exports","module"],function(){if(window.CustomEvent){var t=300,e={};window.addEventListener("touchstart",function(t){for(var i=Date.now(),n=0;n<t.changedTouches.length;n++){var s=t.changedTouches[n];e[s.identifier]=i}}),window.addEventListener("touchmove",function(t){for(var i=0;i<t.changedTouches.length;i++){var n=t.changedTouches[i];delete e[n.identifier]}}),window.addEventListener("touchend",function(i){for(var n=Date.now(),s=0;s<i.changedTouches.length;s++){var r=i.changedTouches[s],o=e[r.identifier];if(o&&t>n-o){i.preventDefault();var a=new window.CustomEvent("click",{bubbles:!0,details:r});i.target.dispatchEvent(a)}delete e[r.identifier]}})}}),i("main",["require","exports","module","famous/core/Engine","src/AppView","famous/inputs/GenericSync","famous/inputs/MouseSync","src/application","src/controller","famous/inputs/FastClick"],function(t){{var e=t("famous/core/Engine"),i=t("src/AppView"),n=t("famous/inputs/GenericSync"),s=t("famous/inputs/MouseSync");t("src/application"),t("src/controller")}t("famous/inputs/FastClick"),n.register(s);var r=e.createContext(),o=[500,1e3];window.innerWidth<520&&(o=[280,1e3]);var a=new i({size:o});r.add(a),r.setPerspective(800)}),e(["main"])}();